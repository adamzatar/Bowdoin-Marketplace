############################################
# Core App
############################################
# Node environment: development | test | production
NODE_ENV=development

# Public base URL for the app (used in emails, NextAuth callbacks, etc.)
APP_URL=http://localhost:3000
# Optional CDN for static/media; leave empty to disable
CDN_URL=

# Log level: fatal | error | warn | info | debug | trace | silent
LOG_LEVEL=info

############################################
# Auth (NextAuth + Okta OIDC)
############################################
# NextAuth required secrets/URLs
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=replace-with-32+-char-random-secret

# Okta OIDC application
OKTA_ISSUER=https://bowdoin.okta.com/oauth2/default
OKTA_CLIENT_ID=replace-with-okta-client-id
OKTA_CLIENT_SECRET=replace-with-okta-client-secret

# RBAC groupâ†’role mapping (JSON). Example:
# { "admin":["grp_admins"], "staff":["grp_staff"], "student":["grp_students"] }
RBAC_GROUP_MAP={"admin":["grp_admins"],"staff":["grp_staff"],"student":["grp_students"]}

# Bowdoin vs Community (Brunswick) affiliation logic
BOWDOIN_EMAIL_DOMAIN=bowdoin.edu
# Optional: additional college-owned domains (comma-separated)
BOWDOIN_ADDITIONAL_DOMAINS=
# Optional: allow-list community email domains (comma-separated), else any non-Bowdoin treated as community
COMMUNITY_EMAIL_DOMAIN_ALLOWLIST=

############################################
# Database (PostgreSQL via Prisma)
############################################
# Primary connection used by the app
DATABASE_URL=postgresql://postgres:secret@localhost:5432/bowdoin_marketplace?schema=public
# Optional: direct connection for connection pooling/bastion (Prisma DIRECT_URL)
DIRECT_URL=
# Used by Prisma Migrate for shadow DB operations (non-production only)
SHADOW_DATABASE_URL=postgresql://postgres:secret@localhost:5432/bowdoin_marketplace_shadow?schema=public

############################################
# Redis (Cache / Queues / Rate Limits)
############################################
REDIS_URL=redis://localhost:6379/0
# Optional TLS flag for managed Redis providers
REDIS_TLS=false

############################################
# Object Storage (S3 or compatible like MinIO/R2)
############################################
S3_ENDPOINT=http://localhost:9000
S3_REGION=us-east-1
S3_BUCKET=bowdoin-marketplace
S3_ACCESS_KEY_ID=minioadmin
S3_SECRET_ACCESS_KEY=minioadmin
# Force path-style URLs for MinIO/compat providers (true|false)
S3_FORCE_PATH_STYLE=true
# Public base URL used to render images (leave empty to auto-derive)
S3_PUBLIC_URL=

############################################
# Image Pipeline (sharp)
############################################
IMAGE_MAX_SIZE_MB=10
IMAGE_MAX_DIMENSION=2560        # max width/height in px
IMAGE_JPEG_QUALITY=82
IMAGE_WEBP_QUALITY=82
IMAGE_STRIP_EXIF=true

############################################
# Email (choose one transport)
############################################
# SMTP transport
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_SECURE=false
SMTP_USER=
SMTP_PASS=
EMAIL_FROM="Bowdoin Marketplace <no-reply@localhost.test>"

# OR: SendGrid transport (leave SMTP blank if using SendGrid)
SENDGRID_API_KEY=

############################################
# Email Verification (Community signups)
############################################
EMAIL_VERIFICATION_TTL_MINUTES=30
EMAIL_VERIFICATION_REQUIRED_FOR_COMMUNITY=true

############################################
# Rate Limits (token bucket per user/IP)
############################################
RATE_LIMIT_GLOBAL_PER_MINUTE=300
RATE_LIMIT_CREATE_LISTING_PER_MINUTE=6
RATE_LIMIT_MESSAGING_PER_MINUTE=30
RATE_LIMIT_UPLOADS_PER_MINUTE=12

############################################
# Security Headers / CSP
############################################
# Report-Only mode to validate CSP in production before enforcing
CSP_REPORT_ONLY=true
# Optional CSP report URI (e.g., to /api/csp-report or external collector)
CSP_REPORT_URI=
# Trust proxies (comma-separated CIDRs or IPs) for correct client IP extraction
TRUSTED_PROXIES=

############################################
# Observability (OpenTelemetry)
############################################
OTEL_SERVICE_NAME=bowdoin-marketplace
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
# Example: "x-honeycomb-team=abc123,x-honeycomb-dataset=prod" or empty
OTEL_EXPORTER_OTLP_HEADERS=
OTEL_TRACES_SAMPLER=parentbased_traceidratio
OTEL_TRACES_SAMPLER_ARG=0.1
# Optional resource attributes (comma-separated key=val pairs)
OTEL_RESOURCE_ATTRIBUTES=deployment.environment=development

############################################
# Feature Flags
############################################
# Comma-separated list of flags to force-enable.
# Recognized flags: brunswickUsers,communitySignup,emailVerification,imagePipelineV2,
# ftsSearchV2,sseMessaging,pwaInstallPrompt,adminImpersonation
FEATURE_FLAGS=brunswickUsers,communitySignup,emailVerification

# Per-flag boolean overrides (highest precedence). Examples:
# FLAG_BRUNSWICKUSERS=true
# FLAG_COMMUNITYSIGNUP=true
# FLAG_EMAILVERIFICATION=true
# FLAG_IMAGEPIPELINEV2=false
# FLAG_FTSSEARCHV2=false
# FLAG_SSEMESSAGING=true
# FLAG_PWAINSTALLPROMPT=false
# FLAG_ADMINIMPERSONATION=false

############################################
# Admin / Ops
############################################
# Emergency read-only mode; disables mutating endpoints when true
READ_ONLY_MODE=false
# Signed cookies/session hardening (NextAuth uses NEXTAUTH_SECRET already, but you may set a cookie prefix)
SESSION_COOKIE_PREFIX=bowdoin_mp_

############################################
# Testing / Local Dev
############################################
# Seed admin email(s) for first-run bootstrap (comma-separated)
SEED_ADMIN_EMAILS=admin@bowdoin.edu
# Local dev CORS origins (comma-separated)
DEV_CORS_ORIGINS=http://localhost:3000